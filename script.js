const imagePaths1 = [
"注音卡 (11).jpg", "注音卡 (12).jpg", "注音卡 (13).jpg", "注音卡 (14).jpg", "注音卡 (15).jpg",
"注音卡 (16).jpg", "注音卡 (17).jpg", "注音卡 (18).jpg", "注音卡 (19).jpg", "注音卡 (20).jpg",
"注音卡 (21).jpg", "注音卡 (22).jpg", "注音卡 (23).jpg", "注音卡 (24).jpg", "注音卡 (25).jpg",
"注音卡 (26).jpg", "注音卡 (27).jpg", "注音卡 (28).jpg", "注音卡 (29).jpg", "注音卡 (30).jpg",
"注音卡 (31).jpg", "注音卡 (32).jpg", "注音卡 (33).jpg", "注音卡 (34).jpg", "注音卡 (35).jpg",
"注音卡 (36).jpg", "注音卡 (37).jpg", "注音卡 (38).jpg", "注音卡 (39).jpg", "注音卡 (40).jpg",
"注音卡 (41).jpg", "注音卡 (42).jpg", "注音卡 (43).jpg", "注音卡 (44).jpg", "注音卡 (45).jpg",
"注音卡 (46).jpg", "注音卡 (47).jpg", "注音卡 (48).jpg", "注音卡 (49).jpg", "注音卡 (50).jpg",
"注音卡 (51).jpg", "注音卡 (52).jpg", "注音卡 (53).jpg", "注音卡 (54).jpg", "注音卡 (55).jpg",
"注音卡 (56).jpg", "注音卡 (57).jpg", "注音卡 (58).jpg", "注音卡 (59).jpg", "注音卡 (60).jpg",
"注音卡 (61).jpg", "注音卡 (62).jpg", "注音卡 (63).jpg", "注音卡 (64).jpg", "注音卡 (65).jpg",
"注音卡 (66).jpg", "注音卡 (67).jpg", "注音卡 (68).jpg", "注音卡 (69).jpg", "注音卡 (70).jpg",
"注音卡 (71).jpg", "注音卡 (72).jpg", "注音卡 (73).jpg", "注音卡 (74).jpg", "注音卡 (75).jpg",
"注音卡 (76).jpg", "注音卡 (77).jpg", "注音卡 (78).jpg", "注音卡 (79).jpg", "注音卡 (80).jpg",
"注音卡 (81).jpg", "注音卡 (82).jpg", "注音卡 (83).jpg", "注音卡 (84).jpg", "注音卡 (85).jpg",
"注音卡 (86).jpg", "注音卡 (87).jpg", "注音卡 (88).jpg", "注音卡 (89).jpg", "注音卡 (90).jpg",
"注音卡 (91).jpg", "注音卡 (92).jpg", "注音卡 (93).jpg", "注音卡 (94).jpg", "注音卡 (95).jpg",
"注音卡 (96).jpg", "注音卡 (97).jpg", "注音卡 (98).jpg", "注音卡 (99).jpg", "注音卡 (100).jpg",
"注音卡 (101).jpg", "注音卡 (102).jpg", "注音卡 (103).jpg", "注音卡 (104).jpg", "注音卡 (105).jpg",
"注音卡 (106).jpg", "注音卡 (107).jpg", "注音卡 (108).jpg", "注音卡 (109).jpg" 
];

const imagePaths2 = [
"圖片卡 (11).jpg", "圖片卡 (12).jpg", "圖片卡 (13).jpg", "圖片卡 (14).jpg", "圖片卡 (15).jpg",
"圖片卡 (16).jpg", "圖片卡 (17).jpg", "圖片卡 (18).jpg", "圖片卡 (19).jpg", "圖片卡 (20).jpg",
"圖片卡 (21).jpg", "圖片卡 (22).jpg", "圖片卡 (23).jpg", "圖片卡 (24).jpg", "圖片卡 (25).jpg",
"圖片卡 (26).jpg", "圖片卡 (27).jpg", "圖片卡 (28).jpg", "圖片卡 (29).jpg", "圖片卡 (30).jpg",
"圖片卡 (31).jpg", "圖片卡 (32).jpg", "圖片卡 (33).jpg", "圖片卡 (34).jpg", "圖片卡 (35).jpg",
"圖片卡 (36).jpg", "圖片卡 (37).jpg", "圖片卡 (38).jpg", "圖片卡 (39).jpg", "圖片卡 (40).jpg",
"圖片卡 (41).jpg", "圖片卡 (42).jpg", "圖片卡 (43).jpg", "圖片卡 (44).jpg", "圖片卡 (45).jpg",
"圖片卡 (46).jpg", "圖片卡 (47).jpg", "圖片卡 (48).jpg", "圖片卡 (49).jpg", "圖片卡 (50).jpg",
"圖片卡 (51).jpg", "圖片卡 (52).jpg", "圖片卡 (53).jpg", "圖片卡 (54).jpg", "圖片卡 (55).jpg",
"圖片卡 (56).jpg", "圖片卡 (57).jpg", "圖片卡 (58).jpg", "圖片卡 (59).jpg", "圖片卡 (60).jpg",
"圖片卡 (61).jpg", "圖片卡 (62).jpg", "圖片卡 (63).jpg", "圖片卡 (64).jpg", "圖片卡 (65).jpg",
"圖片卡 (66).jpg", "圖片卡 (67).jpg", "圖片卡 (68).jpg", "圖片卡 (69).jpg", "圖片卡 (70).jpg",
"圖片卡 (71).jpg", "圖片卡 (72).jpg", "圖片卡 (73).jpg", "圖片卡 (74).jpg", "圖片卡 (75).jpg",
"圖片卡 (76).jpg", "圖片卡 (77).jpg", "圖片卡 (78).jpg", "圖片卡 (79).jpg", "圖片卡 (80).jpg",
"圖片卡 (81).jpg", "圖片卡 (82).jpg", "圖片卡 (83).jpg", "圖片卡 (84).jpg", "圖片卡 (85).jpg",
"圖片卡 (86).jpg", "圖片卡 (87).jpg", "圖片卡 (88).jpg", "圖片卡 (89).jpg", "圖片卡 (90).jpg",
"圖片卡 (91).jpg", "圖片卡 (92).jpg", "圖片卡 (93).jpg", "圖片卡 (94).jpg", "圖片卡 (95).jpg",
"圖片卡 (96).jpg", "圖片卡 (97).jpg", "圖片卡 (98).jpg", "圖片卡 (99).jpg", "圖片卡 (100).jpg",
"圖片卡 (101).jpg", "圖片卡 (102).jpg", "圖片卡 (103).jpg", "圖片卡 (104).jpg", "圖片卡 (105).jpg",
"圖片卡 (106).jpg", "圖片卡 (107).jpg", "圖片卡 (108).jpg", "圖片卡 (109).jpg"];

// 選出 6 對隨機卡牌
let cards = [];
const selectedIndices = [];
while (selectedIndices.length < 6) {
  const index = Math.floor(Math.random() * imagePaths1.length);
  if (!selectedIndices.includes(index)) {
    selectedIndices.push(index);
  }
}

selectedIndices.forEach(i => {
  cards.push({ image: imagePaths1[i], pairId: i });
  cards.push({ image: imagePaths2[i], pairId: i });
});

// 打亂卡牌順序
cards.sort(() => 0.5 - Math.random());

const board = document.getElementById('game-board');
let firstCard = null;
let secondCard = null;
let lock = false;
let matchedPairs = 0;

let startTime;
let timerInterval = null;
const timerDisplay = document.getElementById('timer');

function startTimer() {
  startTime = Date.now();
  timerInterval = setInterval(() => {
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    timerDisplay.innerText = elapsed;
  }, 1000);
}

function stopTimer() {
  clearInterval(timerInterval);
}

function createCard(cardData, index) {
  const card = document.createElement('div');
  card.classList.add('card', 'covered');
  card.dataset.image = 'images/'+cardData.image;
  card.dataset.pairId = cardData.pairId;
  card.dataset.index = index;
  card.style.backgroundImage = "url('images/back.jpg')";

  card.addEventListener('click', () => {
    if (lock || card.classList.contains('matched') || !card.classList.contains('covered')) return;

    card.classList.remove('covered');
    card.style.backgroundImage = `url('images/${cardData.image}')`;

    if (!firstCard) {
      firstCard = card;
      if (!startTime) startTimer();
    } else {
      secondCard = card;
      lock = true;

      if (firstCard.dataset.pairId === secondCard.dataset.pairId) {
        firstCard.classList.add('matched');
        secondCard.classList.add('matched');
        matchedPairs++;
        resetTurn();

        if (matchedPairs === 6) {
          stopTimer();
          const timeTaken = Math.floor((Date.now() - startTime) / 1000);
          document.getElementById('message').innerText = `你贏了！花了 ${timeTaken} 秒。`;
        }
      } else {
        setTimeout(() => {
          firstCard.classList.add('covered');
          secondCard.classList.add('covered');
          firstCard.style.backgroundImage = "url('images/back.jpg')";
          secondCard.style.backgroundImage = "url('images/back.jpg')";
          resetTurn();
        }, 1500);
      }
    }
  });

  return card;
}

function resetTurn() {
  [firstCard, secondCard] = [null, null];
  lock = false;
}

// 建立遊戲卡片
cards.forEach((cardData, index) => {
  const card = createCard(cardData, index);
  board.appendChild(card);
});
